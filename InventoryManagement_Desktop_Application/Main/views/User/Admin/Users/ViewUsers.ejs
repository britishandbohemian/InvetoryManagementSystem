<html>

<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <link rel="stylesheet" href="/css/style.css">
 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
 <!-- Bootstrap CSS -->
 <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
 <link rel="stylesheet"
  href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
 <link rel="stylesheet" href="/css/styles.css">
 <link rel="icon" href="images/Layer-1.ico" type="image/x-icon">



</head>

<body>


 <%- include('../NavBarAdmin') %>



  <div class="main-content">
   <!-- Search Bar -->
   <div class="shadowNav" style="    
      z-index: 2;
      background-color: #fcfcfc;
      display: grid;
      top: 0;
      height: 8rem;
      grid-template-columns: 60% 40%;
align-items: center;
      flex-direction: row;
      position: fixed;
      width: 100%;
      justify-content: left;
border: 1px solid 1px solid rgb(230 230 230);

">
    <h6 style="   font-weight: 800;
      font-size: 1.5em;
      padding-left: 5rem;">Users

    </h6>

    <div style="display: flex;width: 100%;justify-content: right;">


     <div style="position: relative; width: 20vw; margin-right: 24rem;">
      <input class="shadowNav" style="text-align: center;
                          font-size: 0.8em;
                          width: 100%;
                          height: 2.3rem;
                          background-color: #ececec;
                          border: 1px #cfcfcf solid;
                          border-radius: 24px;
                          padding-left: 2.5rem;" type="text" placeholder="Search Inventory">
      <i style="position: absolute; 
                      left: 1rem; 
                      top: 0.5rem; 
                      font-size: 0.8em;
                      color: rgb(158, 158, 158);" class="search-icon"><span style="font-size: 1.5em;"
        class="material-symbols-outlined">
        search
       </span></i>
     </div>



    </div>

   </div>


   <div class="container " style=" padding: 3rem;margin-left: 3rem;margin-top: 5rem;">
    <div class="row">
     <% data.forEach(user=> { %>

      <div class="col-md-4" style="">
       <div class="card"
        style="border: none;display: flex;justify-content: center;margin-top: 2rem;background-color: white;border:  1px solid rgb(216, 216, 216); border-radius: 15px;">
        <div style="display: flex;justify-content: center;">
         <span style="font-size: 4rem;padding-top: 3rem;" class="material-symbols-outlined">
          account_circle
         </span>
        </div>
        <div class="card-body" style="display: flex;justify-content: center;flex-direction: column;">
         <h5 class="card-title"
          style="font-weight: 400; font-size: 1rem; padding-bottom: 1rem; padding-top: 1rem;text-align: center;">
          Username <span style="font-size: 1rem;font-weight: bold;">
           <%= user.username %>
          </span>
         </h5>
         <h5 class="card-title"
          style="font-weight: 400; font-size: 1rem; padding-bottom: 1rem; padding-top: 1rem; text-align: center;">
          User Role
          <span style="font-size: 1rem; font-weight: bold;">
           <% var userRoles=["Employee", "Manager" , "MasterAdmin" , "Supplier" ]; %>
            <%= userRoles[user.role] %>
          </span>
         </h5>

         <div style="  background-color: transparent ; display: flex;
                  justify-content: center;
                  gap: 1rem;">
          <button <% if (user.username==="admin" ) { %> disabled <% } %>
            style="background-color: transparent; color: <%= user.username==='admin' ? '#ccc' : '#000' %>;
             border-bottom: 4px solid #FF0000;"
             onclick='<% if (user.username !=="admin" ) { %> deleteUserById(<%=user.userId%>) <% } %>'
                class="btn">
                <span class="material-symbols-outlined">delete</span>
          </button>
          <a style="background-color: transparent;color: #000000;border-bottom: 4px solid #FF0000;"
           href="/getUserById/<%=user.userId%>" type="button" class="btn">
           <span class="material-symbols-outlined">border_color</span>
          </a>
         </div>
        </div>
       </div>
      </div>
      <% }); %>
    </div>
   </div>

  </div>

  <script>
   function deleteUserById(id) {
    fetch(`/deleteUser/${id}`, {
     method: 'DELETE',
     headers: {
      'Content-Type': 'application/json',
     },
    })
     .then(response => {
      if (!response.ok) {
       throw new Error(`HTTP error! status: ${response.status}`);
      }
     })
     .then(success => {
      if (success) {
       // Reload the page
       window.location.reload();
       window.location.reload();
      } else {
       console.error(message);
       // Optionally show an error message to the user
      }
     })
     .catch(error => {
      console.error(`Failed to delete user: ${message}`);
     });
    location.reload();
   }




  </script>


</body>

</html>